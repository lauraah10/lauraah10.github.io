<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Laura Ahumada and Alan Abadzic" />


<title>Workplace trends and insight on Fritolay</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About me:</a>
</li>
<li>
  <a href="Budweiser_analysis.html">Budweiser Analysis</a>
</li>
<li>
  <a href="CLT2.html">CLT2</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Workplace trends and insight on Fritolay</h1>
<h4 class="author">Laura Ahumada and Alan Abadzic</h4>
<h4 class="date">10/5/2021</h4>

</div>


<ul>
<li>All attributes in the data</li>
</ul>
<pre class="r"><code>#Reading Files
fritolay=read.csv(&quot;CaseStudy2-data.csv&quot;)
# all columns
names(fritolay)</code></pre>
<pre><code>##  [1] &quot;ID&quot;                       &quot;Age&quot;                     
##  [3] &quot;Attrition&quot;                &quot;BusinessTravel&quot;          
##  [5] &quot;DailyRate&quot;                &quot;Department&quot;              
##  [7] &quot;DistanceFromHome&quot;         &quot;Education&quot;               
##  [9] &quot;EducationField&quot;           &quot;EmployeeCount&quot;           
## [11] &quot;EmployeeNumber&quot;           &quot;EnvironmentSatisfaction&quot; 
## [13] &quot;Gender&quot;                   &quot;HourlyRate&quot;              
## [15] &quot;JobInvolvement&quot;           &quot;JobLevel&quot;                
## [17] &quot;JobRole&quot;                  &quot;JobSatisfaction&quot;         
## [19] &quot;MaritalStatus&quot;            &quot;MonthlyIncome&quot;           
## [21] &quot;MonthlyRate&quot;              &quot;NumCompaniesWorked&quot;      
## [23] &quot;Over18&quot;                   &quot;OverTime&quot;                
## [25] &quot;PercentSalaryHike&quot;        &quot;PerformanceRating&quot;       
## [27] &quot;RelationshipSatisfaction&quot; &quot;StandardHours&quot;           
## [29] &quot;StockOptionLevel&quot;         &quot;TotalWorkingYears&quot;       
## [31] &quot;TrainingTimesLastYear&quot;    &quot;WorkLifeBalance&quot;         
## [33] &quot;YearsAtCompany&quot;           &quot;YearsInCurrentRole&quot;      
## [35] &quot;YearsSinceLastPromotion&quot;  &quot;YearsWithCurrManager&quot;</code></pre>
<div id="exploratory-analysis-on-the-data" class="section level1">
<h1>Exploratory Analysis on the data</h1>
<div id="eda-categorical-values" class="section level2">
<h2>EDA: Categorical values</h2>
<pre class="r"><code>#Missing values
missing=sapply(fritolay, function(x) sum(is.na(x))) #no missing values
#data with descriptive values
char_data=fritolay[, sapply(fritolay, class) == &#39;character&#39;]  #9 char values
#data with continuous values
cont_data=fritolay[, sapply(fritolay, class) != &#39;character&#39;]  #27 num values

# unique values in each descriptive value
unique_col=char_data %&gt;% summarize_all(n_distinct)
unique_col=gather(unique_col, Columns_names, Unique_Values, Attrition:OverTime) %&gt;% arrange(Unique_Values)
unique_col</code></pre>
<pre><code>##    Columns_names Unique_Values
## 1         Over18             1
## 2      Attrition             2
## 3         Gender             2
## 4       OverTime             2
## 5 BusinessTravel             3
## 6     Department             3
## 7  MaritalStatus             3
## 8 EducationField             6
## 9        JobRole             9</code></pre>
<pre class="r"><code># Only JobRole and EducationField have more than 3 unique characters

# unique var for all char variable
unique_chars=sapply(char_data, function(x) (unique(x))) #no empty strings or or anything
#remove Over18 there is only one value. Not useful
fritolay=fritolay %&gt;% select(-Over18)</code></pre>
<ul>
<li>No NA’s nor empty values in Categorical data</li>
<li>Only Educational Field and Job Role have more than 3 unique attribute</li>
<li>All people are over 18 years old</li>
<li>Over18 columns can be removed as it has a yes for the whole data</li>
</ul>
<p><strong>Percent distribution</strong> </p>
<p><img src="project2_files/figure-html/unnamed-chunk-5-1.png" width="180%" height="150%" /></p>
<p><img src="project2_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /> <strong>Features vs attrition percent</strong> </p>
<p><img src="project2_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /><img src="project2_files/figure-html/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;" /> #———————————————————————</p>
<p><img src="project2_files/figure-html/unnamed-chunk-8-1.png" width="100%" height="150%" style="display: block; margin: auto;" /> <strong>Insights for categorical variables</strong></p>
<ul>
<li>MaritalStatus vs churn
<ul>
<li>47% of the people are married, followed by single 30% and then divorce 21%</li>
<li>Single people have the highest overturn rate of 26% and divorce has the lowest with 6% ## People that do over time have the highest highest overturn rate of 68% more churn than those that don’t do over time</li>
<li>Those that do Overtime have 32% churn while those that don’t have 9.7%.</li>
<li>Human Resources have the lowest amount of people but the highest churn percent, 27%</li>
<li>HR only has 4%, that is very little. Maybe a survey should also be performed to see if people more HR support is needed to make employees feel confortable.</li>
</ul></li>
</ul>
</div>
<div id="eda-continuos-variables" class="section level2">
<h2>EDA: Continuos Variables</h2>
<p><img src="project2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<ul>
<li><p>Almost 50% of the data with stock option a zero tells that many people opt out or are not given the option of Stock-option.</p></li>
<li><p>Per the amount of zero’s in promotion, it is showing that within a year many people have been promoted.</p></li>
<li><p>Per the zero years with current manager and year in role, we can see that there are quite a few new workers</p></li>
<li><p>Let’s see distribution and stats of everything</p></li>
</ul>
<pre class="r"><code>#summary(cont_data)</code></pre>
<ul>
<li>ID and EmployeeNumber, EmployeeCount,StandardHours should not be used for the model
<ul>
<li>StandardHours and Employee count only have one value, 80 for std hours and 1 for employee count</li>
</ul></li>
<li>People age ranges from 18-60 years old with a mean of 35</li>
<li>Gender distribution
<ul>
<li>59% Male and 41% female</li>
<li>More male and female</li>
</ul></li>
<li>Hourly rate and daily rate, MonthlyRate , standardHours seem to No correlation per graphs</li>
<li>There seems to not be any relationship between Job involvement and job level</li>
<li>Looking at those that have NumCompaniesWorked equal 0:
<ul>
<li>They have worked, it says minimum Years working at the company is 1, performance is mostly 3, they have a monthly income of mean $2,045 which means that these most likely are new employees who haven’t completed a year.</li>
</ul></li>
</ul>
<pre class="r"><code>#are there duplicates?
fritolay[duplicated(fritolay)] # No Duplicates</code></pre>
<pre><code>## data frame with 0 columns and 870 rows</code></pre>
<pre class="r"><code>#remove col
fritolay=fritolay %&gt;% select(-ID, -EmployeeNumber, -EmployeeCount, -NumCompaniesWorked, -StandardHours)

## Looking at those with NumCompnaiesWorked as 0
#fritolay %&gt;% filter(NumCompaniesWorked==0)
#fritolay %&gt;% filter(StockOptionLevel==0)
#fritolay %&gt;% filter(TotalWorkingYears==0) #-----&gt;&gt;&gt;They seem to be new workers. They are 7,  18-19 years old, single with relationship between 3-4,age 18-19, companies worked 1 and it is their first company
#fritolay %&gt;% filter(TrainingTimesLastYear==0)
#fritolay %&gt;% filter(YearsAtCompany==0)
#fritolay %&gt;% filter(YearsInCurrentRole==0)
#YearsSinceLastPromotion, yearswithcurrmanager, YearsInCurrentRole all 0</code></pre>
<ul>
<li>Those with total working years as 0 seem to be new workers. They are 18-19 years old, single, with relationship between 3-4,age 18-19, companies worked 1, and their first company</li>
<li>All zero’s in the data make sense and most seem to portray new workers.</li>
</ul>
<div id="correlation" class="section level3">
<h3>Correlation</h3>
<p><img src="project2_files/figure-html/unnamed-chunk-13-1.png" width="1440" /></p>
<p><strong>Normal trends that should appear in every company, are shown in the company</strong> - Monthly Income vs Job Level - Performance Rate vs Percent Salary Hike level - Monthly Income vs Total Years working - total working years and age - Job level vs monthly income - Monthly income vs total working years - Relationship vs Years With manager - Performance rating vs training - Jobrole vs Worklife balance - Performance Rating vs Relationship with manager - Job level and monthly income vs Total working years .78</p>
<ul>
<li>Research scientist are the happiest with their jobs. They have the highest Job Satisfaction, sales rep</li>
</ul>
</div>
</div>
</div>
<div id="interesting-facts" class="section level1">
<h1>Interesting Facts</h1>
<ul>
<li>People that do not travel have tend to have the lowest overturn rate<br />
</li>
<li>Research and development is the most prevalent department with 64% and it has the highest attriiton rate of 87%<br />
</li>
<li>Director jobs tend to have the lowest turn over rate. Only 2% quit their job</li>
<li>All people that studied Marketing are in sales, just like all people that studied human resources are in human resources. However thoe who had education in: Other, Technical, Science, Medicine work also work in other fields.</li>
<li>17% of those that study medicine ended up going into Sales</li>
<li>2.7% that did Technical deegree ended up in human resources which is surprising</li>
</ul>
</div>
<div id="linear-regression-to-predict-monthly-income" class="section level1">
<h1>Linear regression to predict Monthly Income</h1>
<pre class="r"><code>library(car)
library(lmtest)
library(&quot;car&quot;)
library(splitstackshape)


set.seed(20)#set seed
TrainObs = sample(seq(1,dim(fritolay)[1]),round(.75*dim(fritolay)[1]),replace = FALSE) #75% split
salaryTrain = fritolay[TrainObs,]
salaryTest = fritolay[-TrainObs,]
RMSE_store=c() #Sore all RMSE to compare
Model1_ = lm(MonthlyIncome ~ .-Department-Attrition, data = salaryTrain)
#Using with all the data

#vif(Model1_) #check collinearity
#The variance inflation is  high for JobRole. Due to the strong collinarity between Jobrole and another indepent variable, I need to remove it from model
#let&#39;s see the score though

### Important variables: YearsSinceLastPromotion, TotalWorkingYears,PerformanceRating, MonthlyRate,JobRoleLaboratory Technician,JobRoleManager ,JobRoleResearch Scientist, JobRoleResearch Director , JobLevel, BusinessTravelTravel_Rarely

Model1_ = lm(MonthlyIncome ~ .-Department-JobRole-Attrition, data = salaryTrain) #removing JobRole from the model as it has high collinarity
#vif(Model1_) #check collinearity again
#that is better so we can continue
#summary(Model1_)
#r sqr .90 not bad
Model1_Preds = predict(Model1_, newdata = salaryTest)#Predict
MSPE = mean((salaryTest$MonthlyIncome - Model1_Preds)^2)
RMSE &lt;- function(error) { sqrt(mean(error^2)) }
RMSE(Model1_$residuals)#get RMSE</code></pre>
<pre><code>## [1] 1338.657</code></pre>
<pre class="r"><code>#1338.657

RMSE_store=c(RMSE_store,RMSE(Model1_$residuals))#store value

#Second try using most important values based on model one&#39;s p values
Model2_ = lm(MonthlyIncome~TotalWorkingYears+JobLevel+DistanceFromHome+YearsWithCurrManager,data=salaryTrain)
#vif(Model2_) #no collinearity between the dependent variables
#summary(Model2_)
#R .92
Model2_Preds = predict(Model2_, newdata = salaryTest) #predict
MSPE_2 = mean((salaryTest$MonthlyIncome - Model2_Preds)^2)
RMSE &lt;- function(error) { sqrt(mean(error^2)) }
RMSE(Model2_$residuals) #get RMSE</code></pre>
<pre><code>## [1] 1382.347</code></pre>
<pre class="r"><code>#1351

#Try  model 2.5 using LOOCV
train(MonthlyIncome~TotalWorkingYears+JobLevel+DistanceFromHome+YearsWithCurrManager, method =&quot;lm&quot;, data=fritolay, trControl = trainControl(method=&quot;LOOCV&quot;))</code></pre>
<pre><code>## Linear Regression 
## 
## 870 samples
##   4 predictor
## 
## No pre-processing
## Resampling: Leave-One-Out Cross-Validation 
## Summary of sample sizes: 869, 869, 869, 869, 869, 869, ... 
## Resampling results:
## 
##   RMSE      Rsquared   MAE     
##   1377.913  0.9100788  1038.864
## 
## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
<pre class="r"><code>#RMSE 1377

#Model 3 
Model3_ = lm(MonthlyIncome~TotalWorkingYears+I(TotalWorkingYears^2)+JobLevel+I(JobLevel^2)+DistanceFromHome+YearsWithCurrManager+I(YearsWithCurrManager^2), data=salaryTrain)
#vif(Model3_)#collinearity increased so it won&#39;t be a good model as we fails the assumptions of linear model
#summary(Model3_) #R .92
Model3_Preds = predict(Model3_, newdata = salaryTest) 
MSPE_3 = mean((salaryTest$MonthlyIncome - Model3_Preds)^2)
RMSE &lt;- function(error) { sqrt(mean(error^2)) }
RMSE(Model3_$residuals)</code></pre>
<pre><code>## [1] 1264.69</code></pre>
<pre class="r"><code>#1259 &lt;--better RMSE but too high correlation
#plot(Model3_)

RMSE_store=c(RMSE_store,RMSE(Model3_$residuals)) #save RMSE

#Model4 is better
train(MonthlyIncome~TotalWorkingYears+I(TotalWorkingYears^2)+JobLevel+I(JobLevel^2)+DistanceFromHome+I(DistanceFromHome^2)+YearsWithCurrManager+I(YearsWithCurrManager^2), method =&quot;lm&quot;, data=fritolay, trControl = trainControl(method=&quot;LOOCV&quot;))</code></pre>
<pre><code>## Linear Regression 
## 
## 870 samples
##   4 predictor
## 
## No pre-processing
## Resampling: Leave-One-Out Cross-Validation 
## Summary of sample sizes: 869, 869, 869, 869, 869, 869, ... 
## Resampling results:
## 
##   RMSE      Rsquared   MAE     
##   1286.825  0.9215757  942.0208
## 
## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
<pre class="r"><code>#RMSE 1286</code></pre>
<div id="best-model-was-model-was-model-2" class="section level3">
<h3>Best model was Model was model 2<br />
</h3>
<div id="according-to-the-p-values-produced-the-model-suggest-that-these-are-the-most-influencial-variables-when-predicting-monthly-salary" class="section level4">
<h4>According to the p values produced, the model suggest that these are the most influencial variables when predicting monthly salary:</h4>
<ul>
<li><p>OverTimeYes &lt; 2e-16 ***<br />
</p></li>
<li><p>JobInvolvement 1.20e-07 ***<br />
</p></li>
<li><p>JobSatisfaction 4.79e-06 ***<br />
</p></li>
<li><p>MonthlyIncome 0.000154 ***</p></li>
<li><p>MaritalStatusSingle 0.000412 ***</p></li>
<li><p>YearsSinceLastPromotion 0.004467 **</p></li>
<li><p>Graph of Linear model results</p></li>
</ul>
<pre class="r"><code>new=salaryTest
new$Predictions=Model2_Preds
new %&gt;% ggplot(aes(salaryTest$MonthlyIncome,Predictions)) + geom_point() + geom_smooth()+ ggtitle(&quot;Actual vs predictions&quot;)+ xlab(&quot;Actual&quot;)+
  ylab(&quot;Predicted&quot;)</code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>RMSE_store=c(RMSE_store,RMSE(Model2_$residuals))#store value</code></pre>
<div id="predict-salary-utilizing-the-best-model" class="section level5">
<h5>Predict salary utilizing the best model</h5>
<pre class="r"><code>#Now let&#39;s predict with our best model with not too much collinearity  Model 2
NoSalary=read.csv(&quot;CaseStudy2CompSet No Salary.csv&quot;)
Model2_Preds = predict(Model2_, newdata = NoSalary)
NoSalary$MonthlyIncome=Model2_Preds
NoSalary=NoSalary %&gt;% select(ID,MonthlyIncome)
write.csv(NoSalary,file=&quot;NoSalaryResult.csv&quot;, row.names=FALSE) #creates new CSV with results</code></pre>
</div>
</div>
</div>
</div>
<div id="naibebays-to-predict-attrition" class="section level1">
<h1>NaibeBays to predict Attrition</h1>
<pre class="r"><code>#Changing &quot;Attrition&quot; variable to a binary value
fritolay$AttritionBin&lt;-ifelse(fritolay$Attrition==&quot;Yes&quot;,1,0)
#get an idea on most important variables using lenear regression utilizing the categorical column of attrition
Model1_ = lm(AttritionBin ~ .-Attrition, data = fritolay)
#summary(Model1_)
#let&#39;s create a model with them and check
t2=lm(AttritionBin ~ OverTime+JobInvolvement+JobSatisfaction+MonthlyIncome+MaritalStatus+YearsSinceLastPromotion, data = fritolay)
#summary(t2)
#vif(t2) #not toomuch correlaiton! great! let&#39;s start with these variables

##Explore the density of Monthly income to standarize it
#ggplot(fritolay, aes(MonthlyIncome)) + geom_density(fill=&quot;blue&quot;)
#ggplot(fritolay, aes(log(MonthlyIncome))) + geom_density(fill=&quot;blue&quot;)
#ggplot(fritolay, aes(sqrt(MonthlyIncome))) + geom_density(fill=&quot;blue&quot;)

#Standarizing Monthly income with log as it seem to give the best distribution
fritolay$logMonthlyIncome&lt;-log(fritolay$MonthlyIncome)

#Testing Accuracy of Naive Bayes model

library(e1071)
splitPerc = .70 #split 70%
trainIndices = sample(1:dim(fritolay)[1],round(splitPerc*dim(fritolay)[1]))
train = fritolay[trainIndices,]
test = fritolay[-trainIndices,]

#Test 1
model = naiveBayes(train,train$Attrition)
prediction = table(predict(model,test),test$Attrition)
CM = confusionMatrix(prediction, positive = &quot;Yes&quot;)
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  220   0
##   Yes   0  41
##                                     
##                Accuracy : 1         
##                  95% CI : (0.986, 1)
##     No Information Rate : 0.8429    
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16 
##                                     
##                   Kappa : 1         
##                                     
##  Mcnemar&#39;s Test P-Value : NA        
##                                     
##             Sensitivity : 1.0000    
##             Specificity : 1.0000    
##          Pos Pred Value : 1.0000    
##          Neg Pred Value : 1.0000    
##              Prevalence : 0.1571    
##          Detection Rate : 0.1571    
##    Detection Prevalence : 0.1571    
##       Balanced Accuracy : 1.0000    
##                                     
##        &#39;Positive&#39; Class : Yes       
## </code></pre>
<ul>
<li>Overfitted the data</li>
</ul>
<pre class="r"><code>#test 2
model2=naiveBayes(Attrition ~ OverTime+JobInvolvement+JobSatisfaction+MonthlyIncome+MaritalStatus+YearsSinceLastPromotion+logMonthlyIncome+EnvironmentSatisfaction+DistanceFromHome+WorkLifeBalance+JobRole+RelationshipSatisfaction, data=fritolay)
prediction2 = table(predict(model2,test),test$Attrition)
CM = confusionMatrix(prediction2, positive = &quot;Yes&quot;)
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  217  13
##   Yes   3  28
##                                           
##                Accuracy : 0.9387          
##                  95% CI : (0.9024, 0.9646)
##     No Information Rate : 0.8429          
##     P-Value [Acc &gt; NIR] : 1.887e-06       
##                                           
##                   Kappa : 0.743           
##                                           
##  Mcnemar&#39;s Test P-Value : 0.02445         
##                                           
##             Sensitivity : 0.6829          
##             Specificity : 0.9864          
##          Pos Pred Value : 0.9032          
##          Neg Pred Value : 0.9435          
##              Prevalence : 0.1571          
##          Detection Rate : 0.1073          
##    Detection Prevalence : 0.1188          
##       Balanced Accuracy : 0.8346          
##                                           
##        &#39;Positive&#39; Class : Yes             
## </code></pre>
<div id="predict-on-unlabled-data" class="section level5">
<h5>Predict on unlabled data</h5>
<pre class="r"><code>#Predict on unlabeled data
NoAttrition=read.csv(&quot;CaseStudy2CompSet No Attrition.csv&quot;)
Attrition_Preds = predict(model2,NoAttrition)
NoAttrition$Attrition=Attrition_Preds
NoAttrition=NoAttrition %&gt;% select(ID,Attrition)

#Create CSV
write.csv(NoAttrition,file=&quot;NoAttritionResult.csv&quot;, row.names=FALSE)
#read.csv(&quot;NoAttritionResult.csv&quot;)


#Verifying top 3 factors for attrition
#CM = confusionMatrix(prediction, positive = &quot;Yes&quot;)
#m1 &lt;- glm(AttritionBin~JobSatisfaction+OverTime+JobInvolvement, #family=binomial, data=fritolay)
#summary(m1)</code></pre>
</div>
<div id="graphs-used-to-gather-some-of-the-above-analysis-and-to-understand-data" class="section level3">
<h3>Graphs used to gather some of the above analysis and to understand data</h3>
<pre class="r"><code>library(corrplot)
#pred &lt;- Model1_ %&gt;%predict_classes(salaryTest) %&gt;% factor(0:8)

#help(predict_class)
 
#res_tab &lt;- table(Pred = pred, Act = test_labels)
#res_prop &lt;- prop.table(res_tab,2)
 
#author_key &lt;- tibble(author = nt_frame$author, code = nt_frame$author_factor) %&gt;%
 # unique %&gt;%
#  arrange(code)
 
#colnames(res_prop) &lt;- author_key$author
#rownames(res_prop) &lt;- author_key$author
#corrplot(res_prop,is.corr = FALSE,
        # method = &quot;circle&quot;, addCoef.col = &quot;lightblue&quot;, number.cex = 0.7)</code></pre>
<ul>
<li>Checking what constitute each department segment</li>
</ul>
<pre class="r"><code>unique(fritolay %&gt;% filter(Department==&quot;Sales&quot;) %&gt;% select(JobRole))</code></pre>
<pre><code>##                JobRole
## 1      Sales Executive
## 4 Sales Representative
## 9              Manager</code></pre>
<pre class="r"><code>unique(fritolay %&gt;% filter(Department==&quot;Research &amp; Development&quot;) %&gt;% select(JobRole))</code></pre>
<pre><code>##                      JobRole
## 1          Research Director
## 2     Manufacturing Director
## 3         Research Scientist
## 6  Healthcare Representative
## 7                    Manager
## 14     Laboratory Technician</code></pre>
<pre class="r"><code>unique(fritolay %&gt;% filter(Department==&quot;Human Resources&quot;) %&gt;% select(JobRole))</code></pre>
<pre><code>##           JobRole
## 1 Human Resources
## 3         Manager</code></pre>
<pre class="r"><code># Manager Appears on both Sales and Research Development so lets update the name
fritolay[fritolay==&quot;Manager&quot; &amp; fritolay$Department==&quot;Sales&quot;]=&quot;Sales Manager&quot;
fritolay[fritolay==&quot;Manager&quot; &amp; fritolay$Department==&quot;Human Resources&quot;]=&quot;HR Manager&quot;</code></pre>
<ul>
<li>Education vs department insights</li>
</ul>
<pre class="r"><code>library(viridis)
library(&quot;ggsci&quot;)

# Discrete color
fritolay %&gt;% ggplot(aes (y=EducationField, fill=Department)) + geom_bar() + 
  ylab(&quot;Education Field&quot;) + 
  ggtitle(&quot;Educational field vs Department&quot;) </code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code>fritolay %&gt;% group_by(EducationField) %&gt;% summarize(Total_people=n(), Sales=paste((0+(round(((sum(Department==&quot;Sales&quot;)/n())*100),1))),&quot;%&quot;,sep=&quot;&quot;), Research=paste((0+(round(((sum(Department==&quot;Research &amp; Development&quot;)/n())*100),1))),&quot;%&quot;, sep=&quot;&quot;), HR=paste((0+(round(((sum(Department==&quot;Human Resources&quot;)/n())*100),1))),&quot;%&quot;, sep=&quot;&quot;))</code></pre>
<pre><code>## # A tibble: 6 × 5
##   EducationField   Total_people Sales Research HR   
##   &lt;chr&gt;                   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;
## 1 Human Resources            15 0%    0%       100% 
## 2 Life Sciences             358 26.5% 70.9%    2.5% 
## 3 Marketing                 100 100%  0%       0%   
## 4 Medical                   270 17.4% 79.6%    3%   
## 5 Other                      52 23.1% 75%      1.9% 
## 6 Technical Degree           75 25.3% 72%      2.7%</code></pre>
<ul>
<li><p>All people that studied Marketing are in sales, just like all people that studied human resources are in human resources. However thoe who had education in: Other, Technical, Science, Medicine work also work in other fields.</p></li>
<li><p>17% of those that study medicine ended up going into Sales</p></li>
<li><p>2.7% that did Technical deegree ended up in human resources which is surprising</p></li>
<li><p>Rest of graphs to understand data</p></li>
</ul>
<p><img src="project2_files/figure-html/unnamed-chunk-23-1.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-23-2.png" width="672" /></p>
<p><img src="project2_files/figure-html/unnamed-chunk-24-1.png" width="180%" height="250%" /></p>
<ul>
<li>There also seems to not be any patterns between Rate columns and Attrition nor between Daily, montly and hourly rate.</li>
</ul>
<p><img src="project2_files/figure-html/unnamed-chunk-25-1.png" width="180%" height="150%" /><img src="project2_files/figure-html/unnamed-chunk-25-2.png" width="180%" height="150%" /></p>
<pre class="r"><code>#new_day==cont_data %&gt;% select(&quot;DailyRate&quot;)
#does not equals daily Rate!
ggplot(fritolay, aes(x=Age, fill=as.factor(JobSatisfaction))) + geom_bar() </code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code>ggplot(fritolay, aes(y=YearsSinceLastPromotion,color=as.factor(JobSatisfaction))) + geom_boxplot() </code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<pre class="r"><code>ggplot(fritolay, aes(x=YearsSinceLastPromotion, fill=as.factor(JobSatisfaction))) + geom_bar() </code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-3.png" width="672" /></p>
<pre class="r"><code>cor.test(x=fritolay$JobSatisfaction, y=fritolay$YearsSinceLastPromotion,method = &quot;spearman&quot;)</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fritolay$JobSatisfaction and fritolay$YearsSinceLastPromotion
## S = 110395779, p-value = 0.8625
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##          rho 
## -0.005880834</code></pre>
<pre class="r"><code>#no correclation btw years an las promotion

ggplot(fritolay, aes(x=YearsSinceLastPromotion, y=JobSatisfaction, color=as.factor(JobSatisfaction))) + geom_col() </code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-4.png" width="672" /></p>
<pre class="r"><code>#environment satisfaction vs jobsatisfaction

ggplot(fritolay, aes(x=EnvironmentSatisfaction, y=JobSatisfaction, color=as.factor(JobSatisfaction))) + geom_col()</code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-5.png" width="672" /></p>
<pre class="r"><code>cor.test(x=fritolay$EnvironmentSatisfaction, y=fritolay$JobSatisfaction,method = &quot;spearman&quot;)</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  fritolay$EnvironmentSatisfaction and fritolay$JobSatisfaction
## S = 111511310, p-value = 0.6365
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##         rho 
## -0.01604509</code></pre>
<pre class="r"><code>#no correlation

ggplot(fritolay, aes(x=EnvironmentSatisfaction, fill=as.factor(JobSatisfaction))) + geom_bar()</code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-6.png" width="672" /></p>
<pre class="r"><code>ggplot(fritolay, aes(y=EnvironmentSatisfaction, fill=as.factor(JobSatisfaction))) + geom_boxplot()</code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-7.png" width="672" /></p>
<pre class="r"><code>ggplot(fritolay, aes(y=(JobRole), fill=as.factor(JobSatisfaction))) + geom_bar()</code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-8.png" width="672" /></p>
<pre class="r"><code>ggplot(fritolay, aes(y=(WorkLifeBalance), fill=as.factor(Attrition))) + geom_bar()</code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-9.png" width="672" /></p>
<pre class="r"><code>#no coee


l=fritolay  %&gt;% group_by(JobRole) %&gt;% summarize(one=round(((sum(JobSatisfaction==1)/n())*100),1),
                   two=round(((sum(JobSatisfaction==2)/n())*100),1),
                   three=round(((sum(JobSatisfaction==3)/n())*100),1),
                   four=round(((sum(JobSatisfaction==4)/n())*100),1)) 


ggplot(fritolay, aes(y= as.factor(JobRole),  group=JobSatisfaction)) + 
    geom_bar(aes(x = ..prop.., fill = factor(..y..)), stat=&quot;count&quot;) +
    geom_text(size=2,aes( label = scales::percent(..prop..),
                   x= ..prop.. ), stat= &quot;count&quot;, vjust = -.3) +
    labs(y = &quot;Percent&quot;) +
    facet_grid(~JobSatisfaction)+ scale_x_continuous(labels = scales::percent) +
  scale_y_discrete(labels = function(x) str_wrap(x, width = 3)) </code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-10.png" width="672" /></p>
<pre class="r"><code>#there seems to not be a relationship between environment and job satisfaction

#monthly rate + job_satisfaction
ggplot(fritolay, aes(y=MonthlyRate, color=as.factor(JobSatisfaction))) + geom_boxplot() </code></pre>
<p><img src="project2_files/figure-html/unnamed-chunk-26-11.png" width="672" /></p>
<pre class="r"><code>#the satisfaction for 3 and 4 have a higher mean monthly rate than that of 1 and 2

f=fritolay %&gt;% group_by(EnvironmentSatisfaction) %&gt;% summarize(one=round(((sum(JobSatisfaction==1)/n())*100),1),
                   two=round(((sum(JobSatisfaction==2)/n())*100),1),
                   three=round(((sum(JobSatisfaction==3)/n())*100),1),
                   four=round(((sum(JobSatisfaction==4)/n())*100),1)) </code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
